% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est_onesample.R
\name{est_onesample}
\alias{est_onesample}
\title{Sample Size Estimation for a Single Proportion}
\usage{
est_onesample(p, p0, alpha, assurance, rep)
}
\arguments{
  \item{p}{Numeric. The true population proportion to be estimated. Must be in the range (0, 1).}

  \item{p0}{Numeric. The threshold proportion for evaluating the lower bound of the confidence interval (CI). Must be in the range (0, 1).}

  \item{alpha}{Numeric. The significance level for the CI (e.g., 0.05 for 95\% confidence). Must be in the range (0, 1).}

  \item{assurance}{Numeric. The desired assurance probability (e.g., 0.8 for 80\% assurance). Must be in the range (0, 1).}

  \item{rep}{Integer. The number of simulation replications to evaluate assurance and coverage probabilities. Must be a positive integer.}
}
\value{
A data frame with the following columns:
\itemize{
  \item \code{p0}: The specified threshold proportion.
  \item \code{p}: The true population proportion.
  \item \code{assurance}: The desired assurance probability.
  \item \code{Nw}: Sample size estimated using the Wald method.
  \item \code{Ns}: Sample size estimated using the Wilson score method.
  \item \code{EAPw}: Empirical assurance probability for the Wald method (percentage).
  \item \code{EAPs}: Empirical assurance probability for the Wilson score method (percentage).
  \item \code{CPw}: Confidence interval coverage probability for the Wald method (percentage).
  \item \code{CPs}: Confidence interval coverage probability for the Wilson score method (percentage).
}
}
\description{
This function estimates the required sample size for a single proportion based on the Wald and Wilson score methods.
It evaluates empirical assurance probabilities and confidence interval (CI) coverage probabilities through simulations.
}
\details{
The \code{est_onesample} function performs the following steps to estimate sample sizes and evaluate probabilities:
\enumerate{
  \item Computes sample sizes using both the Wald and Wilson score methods.
  \item Simulates confidence intervals for the specified sample sizes.
  \item Calculates assurance probability (percentage of simulations where the lower CI bound exceeds \code{p0}) and
        coverage probability (percentage of simulations where the true proportion lies within the CI).
}

The Wilson score method is generally more accurate than the Wald method, particularly when the true proportion \code{p} is close to 0 or 1.
}
\note{
\itemize{
  \item \code{p0} specifies the minimum acceptable value for the lower CI bound.
  \item For extreme proportions, the Wilson score method is more reliable.
  \item Larger \code{rep} values yield more precise results but increase computation time.
}
}
\examples{
# Example 1: High true proportion
result <- est_onesample(
  p = 0.95,
  p0 = 0.85,
  alpha = 0.05,
  assurance = 0.8,
  rep = 100  # Reduced rep for quick computation
)
print(result)

# Example 2: Moderate true proportion
result <- est_onesample(
  p = 0.6,
  p0 = 0.5,
  alpha = 0.05,
  assurance = 0.9,
  rep = 500
)
print(result)
}
